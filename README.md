# Web Archiver Action

[![GitHub release](https://img.shields.io/github/v/release/annabarnes1138/web-archiver-action)](https://github.com/annabarnes1138/web-archiver-action/releases)

A reusable GitHub Actions composite action that archives a list of web artifacts—such as websites, file URLs, or subreddit names. This version accepts a JSON input for artifacts so that you can include optional descriptions with each artifact. It:
- Downloads and archives each artifact (using `wget` for websites/files and a specialized process for subreddits by archiving only the wiki page)
- **Separates artifact processing into individual scripts** for easier readability and maintainability:
  - `scripts/handle_website.sh` handles website URLs
  - `scripts/handle_subreddit.sh` handles subreddit artifacts by archiving only the wiki page
  - `scripts/handle_artifact.sh` acts as a dispatcher to call the appropriate script
- Generates a `README.md` documenting each archived item, including:
  - A static description (if provided)
  - An optional per-artifact description (if provided in the JSON input)
  - The date each artifact was last archived
  - The run schedule and links to download a ZIP of the repository and view the published GitHub Pages site
- Creates an `index.html` linking to the archived artifacts
- Commits the changes to the repository
- Deploys the content (including a dedicated `static` folder) to GitHub Pages

## Repository Structure

```plaintext
web-archiver-action/
├── scripts/
│   ├── handle_artifact.sh      # Dispatcher script that selects the proper handler
│   ├── handle_website.sh       # Processes website URLs
│   └── handle_subreddit.sh     # Archives only the subreddit's wiki page
├── action.yml                  # Composite action definition
├── README.md                   # This file
└── LICENSE
```

## Usage

This repository contains a composite action that you can incorporate into your own GitHub Actions by referencing it. The action now accepts a JSON array for the artifacts input. Each object in the JSON array should include a `"url"` property and may optionally include a `"description"`. Additionally, you can provide a static description that will appear at the top of the generated README.

To use the action, create a workflow file (e.g., `.github/workflows/archive.yml`) with the following content:

```yaml
name: Archive Artifacts

on:
  # Trigger on a schedule and/or manually.
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  archive:
    runs-on: ubuntu-latest
    steps:
      - name: Run Web Archiver Composite Action
        uses: annabarnes1138/web-archiver-action@v1.3
        with:
          # Provide a JSON array of artifact objects. Each object must include a "url" and may include a "description".
          artifacts: |
            [
              { "url": "https://example.com", "description": "Example website" },
              { "url": "r/AskReddit", "description": "Subreddit Wiki for AskReddit" },
              { "url": "https://example.com/file.pdf" }
            ]
          schedule: "Daily at midnight (UTC)"
          static_description: "This archive was generated by the Web Archiver Action."
          github_token: ${{ secrets.GITHUB_TOKEN }}